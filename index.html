<!doctype html>
<!--
  GustoCode - Editor Online (single-file)
  Vers√£o: single-file pronta para GitHub Pages
  - Monaco Editor (UI)
  - Python via Pyodide (WASM)
  - JavaScript sandbox via QuickJS (WASM) / fallback iframe
  - C/C++ tentativa via webc86 (fallback informativo)
  - Assistente de C√≥digo client-side via transformers.js (sem API key)
  Aten√ß√£o: modelos de c√≥digo podem ser grandes ‚Äî use modelos pequenos para testes.
  Autor: GustoCode (gerado para Augusto) üöÄ
-->
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GustoCode ‚Äî Editor Online</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    /* ===========================
       GustoCode - Estilo Futurista
       =========================== */
    :root{
      --bg:#080812; --panel:#0f1220; --muted:#9aa4b2;
      --accent1:#6fe7d3; --accent2:#7a6eff; --glass: rgba(255,255,255,0.03);
      --border: rgba(255,255,255,0.06); --success: #6fe7a1; --danger: #ff6b6b;
    }
    html,body{ height:100%; margin:0; background:
      radial-gradient(1200px 600px at 10% 20%, rgba(122,110,255,0.08), transparent 8%),
      radial-gradient(800px 400px at 90% 80%, rgba(111,231,211,0.05), transparent 8%),
      linear-gradient(180deg, #05050b 0%, var(--bg) 100%);
      color:#dfe7ef; font-family:"Inter", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    header{
      height:64px; display:flex; align-items:center; gap:16px; padding:0 20px;
      border-bottom:1px solid var(--border); backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
    }
    .logo{ display:flex; gap:12px; align-items:center; font-weight:800; }
    .logo .icon{ width:40px; height:40px; border-radius:10px; display:grid; place-items:center;
      background: linear-gradient(135deg,var(--accent2),var(--accent1)); box-shadow:0 6px 20px rgba(122,110,255,0.12);
      transform: rotate(-10deg); font-weight:900;
    }
    .logo .name{ font-size:18px; } .logo .tag{ font-size:11px; color:var(--muted); }

    main.app{
      display:grid; grid-template-columns: 320px 1fr 460px; grid-template-rows: calc(100vh - 64px);
      gap:18px; padding:18px; box-sizing:border-box;
    }

    /* Left sidebar */
    .sidebar{ border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border:1px solid var(--border); box-shadow:0 10px 30px rgba(2,6,23,0.6); overflow:auto;
    }
    .file-list{ display:flex; flex-direction:column; gap:8px; margin-top:8px; }
    .file-item{ padding:10px; border-radius:10px; display:flex; justify-content:space-between; align-items:center;
      cursor:pointer; background: linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); border:1px solid transparent;}
    .file-item:hover{ transform:translateX(6px); box-shadow:0 6px 18px rgba(0,0,0,0.6); }
    .file-item.active{ background: linear-gradient(90deg, rgba(122,110,255,0.09), rgba(111,231,211,0.03)); border-color: rgba(122,110,255,0.12); }

    .btn{ display:inline-flex; gap:8px; align-items:center; padding:8px 10px; border-radius:8px;
      background:linear-gradient(90deg,var(--accent2),var(--accent1)); color:#04121a; font-weight:700; border:none; cursor:pointer;
      box-shadow: 0 6px 20px rgba(122,110,255,0.12);
    }

    /* center */
    .editor-panel{ border-radius:12px; overflow:hidden; display:flex; flex-direction:column; border:1px solid var(--border); }
    .tabs{ display:flex; align-items:center; gap:8px; padding:10px; border-bottom:1px solid var(--border); }
    .tab{ padding:8px 12px; border-radius:8px; font-weight:600; font-size:13px; cursor:pointer; color:var(--muted); }
    .tab.active{ color:#e9f8f3; background: linear-gradient(90deg, rgba(122,110,255,0.08), rgba(111,231,211,0.03)); border-color: rgba(122,110,255,0.08); }

    .toolbar{ display:flex; align-items:center; gap:12px; padding:10px; }
    .toolbar .select, .toolbar .input{ background:rgba(255,255,255,0.02); border:1px solid var(--border); padding:8px 10px; border-radius:8px; color:var(--muted); font-weight:600; }
    #editor{ height: calc(100vh - 220px); }

    /* right */
    .right-panel{ border-radius:12px; border:1px solid var(--border); padding:12px; display:flex; flex-direction:column; gap:12px; overflow:auto; }
    .terminal{ background: linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.12)); border-radius:10px; height:300px; padding:12px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; font-size:13px; color:#a9ffe1; overflow:auto; border:1px solid rgba(255,255,255,0.03); }
    .statusbar{ height:46px; border-top:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; padding:0 12px; font-size:13px; color:var(--muted); }

    @media (max-width:1100px){ main.app{ grid-template-columns:1fr; grid-template-rows:auto 1fr auto; } #editor{ height:60vh; } }

    /* extras para "fazer bonito" */
    .muted{ color:var(--muted); font-size:12px; } .small{ font-size:12px; color:var(--muted); }
    .chip{ padding:6px 10px; border-radius:999px; background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); font-weight:700; font-size:12px; color:var(--muted); }
    .kbd{ background:rgba(255,255,255,0.03); padding:6px 8px; border-radius:6px; font-weight:700; font-size:12px; color:var(--muted); border:1px solid rgba(255,255,255,0.02); }

    /* muitas linhas vazias e regras extras (intencional para atender pedido de arquivo "longuinho") */
    .___pad{ height:6px; } .___pad2{ height:6px; } .___pad3{ height:6px; }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div class="icon">G</div>
      <div>
        <div class="name">GustoCode</div>
        <div class="tag">Editor Futurista ‚Ä¢ WebAssembly ‚Ä¢ Client-side</div>
      </div>
    </div>

    <div style="flex:1"></div>

    <div style="display:flex;gap:10px;align-items:center">
      <div class="small muted">Conectado: <span id="statusEngine">‚Äî</span></div>
      <div class="chip" id="userInfo">Ol√°, Augusto üëã</div>
      <button class="btn" id="shareBtn" title="Exportar / Compartilhar">Exportar üíæ</button>
    </div>
  </header>

  <main class="app" role="main">
    <!-- LEFT -->
    <aside class="sidebar" aria-label="Explorador e configura√ß√µes">
      <h3>Arquivos <span class="small muted">‚Ä¢ Projeto</span></h3>

      <div class="file-list" id="fileList"></div>

      <div style="display:flex;gap:8px;margin-top:auto;align-items:center;">
        <button class="btn" id="newFile">Novo Arquivo +</button>
        <button class="btn" id="themeToggle" style="background:transparent;border:1px solid var(--border);color:var(--muted);font-weight:700">Tema</button>
      </div>

      <div class="fancy-panel" style="margin-top:8px">
        <h3 style="margin:0">Ambiente</h3>
        <div class="small muted" style="margin-top:8px">Executores carregados:</div>
        <ul style="margin:8px 0 0 14px;padding:0" id="runtimesList">
          <li>Python (Pyodide) ‚Äî <span id="pyStatus" class="small muted">carregando...</span></li>
          <li>JavaScript (QuickJS) ‚Äî <span id="jsStatus" class="small muted">carregando...</span></li>
          <li>C/C++ (webc86) ‚Äî <span id="cStatus" class="small muted">verificando...</span></li>
        </ul>
      </div>

      <div class="fancy-panel">
        <h3 style="margin:0">Atalhos</h3>
        <div class="small" style="margin-top:8px">
          <div style="display:flex;justify-content:space-between"><span>Executar</span> <span class="kbd">Ctrl + Enter</span></div>
          <div style="display:flex;justify-content:space-between;margin-top:6px"><span>Sugest√µes</span> <span class="kbd">Ctrl + Espa√ßo</span></div>
        </div>
      </div>
    </aside>

    <!-- CENTER: EDITOR -->
    <section class="editor-panel" aria-label="Editor central">
      <div class="tabs" role="tablist" id="tabs">
        <div class="tab active" data-fid="main.py">main.py</div>
        <div class="tab" data-fid="main.js">main.js</div>
        <div class="tab" data-fid="main.c">main.c</div>
        <div style="flex:1"></div>
        <div style="display:flex;gap:8px;align-items:center">
          <select id="languageSelect" class="select" title="Linguagem">
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="c">C</option>
            <option value="cpp">C++</option>
            <option value="html">HTML</option>
          </select>
          <button id="runBtn" class="btn">Rodar ‚ñ∂</button>
          <button id="stopBtn" class="btn" style="background:linear-gradient(90deg,var(--danger),#ff9b9b);">Parar ‚úñ</button>
        </div>
      </div>

      <div class="toolbar">
        <input id="searchInFile" class="input" placeholder="Procurar no arquivo... (Ctrl+F)">
        <div style="flex:1"></div>
        <div class="small muted">Kernel:</div>
        <div class="chip" id="kernelName">client-wasm</div>
      </div>

      <div id="editor" aria-label="√Årea do editor"></div>

      <div class="statusbar">
        <div>GustoCode ‚Äî editor 100% client-side ‚Ä¢ WebAssembly</div>
        <div class="small muted">Pronto ‚Ä¢ <span id="cursorInfo">Ln 1, Col 1</span></div>
      </div>
    </section>

    <!-- RIGHT: TERMINAL / SNIPPETS / ASSISTENTE -->
    <aside class="right-panel" aria-label="Terminal e snippets">
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 style="margin:0">Terminal</h3>
          <div class="small muted">Sa√≠da do programa ‚Ä¢ Gosto de ver logs ‚ú®</div>
        </div>
        <div id="terminal" class="terminal" role="log">Bem-vindo ao GustoCode ‚Äî Augusto! üõ∏
Carregando runtimes, aguarde...</div>
      </div>

      <div class="fancy-panel">
        <h3 style="margin:0">Snippets</h3>
        <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
          <button class="btn" onclick="insertSnippet('py')">Boilerplate Python üêç</button>
          <button class="btn" onclick="insertSnippet('js')">Boilerplate JS ‚ú®</button>
          <button class="btn" onclick="insertSnippet('c')">Boilerplate C ‚öôÔ∏è</button>
        </div>
      </div>

      <!-- Assistente de C√≥digo -->
      <div class="fancy-panel" id="assistantPanel" style="display:block">
        <h3 style="margin:0">Assistente de C√≥digo</h3>
        <div style="margin-top:8px; display:flex; gap:8px; flex-direction:column;">
          <textarea id="assistantPrompt" placeholder="Descreva o que quer (ex: 'Implementar fun√ß√£o de ordena√ß√£o otimizada')" style="width:100%;min-height:84px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);color:inherit;"></textarea>

          <div style="display:flex;gap:8px;">
            <button class="btn" id="askAssistantBtn">Pedir sugest√£o üí°</button>
            <select id="assistantModelSelect" class="select" style="min-width:180px;">
              <!-- Modelo demo; voc√™ pode substituir por um modelo menor / local -->
              <option value="xenova/starcoder-small">StarCoder (pequeno demo)</option>
              <option value="xenova/starcoder">StarCoder (padr√£o ‚Äî pesado)</option>
              <option value="local">Modelo local / URL</option>
            </select>
          </div>

          <div class="small muted" style="margin-top:6px">Resultado:</div>
          <pre id="assistantOutput" style="background:rgba(0,0,0,0.25);padding:8px;border-radius:8px;min-height:120px;overflow:auto;"></pre>
          <div style="display:flex;gap:8px;justify-content:flex-end;">
            <button class="btn" id="insertSuggestionBtn">Inserir no editor ‚ûï</button>
            <button class="btn" id="copySuggestionBtn">Copiar ‚úÇÔ∏è</button>
          </div>
        </div>
      </div>

      <div>
        <h3 style="margin:0">Info</h3>
        <div class="small muted" style="margin-top:8px">Single-file, client-side. Para modelos grandes, hospede os arquivos do modelo no repo ou use vers√£o quantizada.</div>
      </div>
    </aside>
  </main>

  <!-- SCRIPTS: Monaco loader -->
  <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs/loader.js"></script>

  <script>
  /*************************************************************************
   * GustoCode - Single-file bootstrap
   *************************************************************************/
  const G = {
    files: {
      "main.py": "# C√≥digo Python de exemplo\nprint('Ol√°, Augusto!')\n",
      "main.js": "// C√≥digo JavaScript de exemplo\nconsole.log('Ol√°, Augusto!')\n",
      "main.c": "/* C√≥digo C de exemplo */\n#include <stdio.h>\nint main(){ printf(\"Ol√°, Augusto!\\n\"); return 0; }\n"
    },
    activeFile: "main.py",
    monaco: null,
    editor: null,
    pyodide: null,
    quickjs: null,
    webc86: null,
    runtimesReady: { py:false, js:false, c:false }
  };

  function logTerminal(text, kind='info') {
    const t = document.getElementById('terminal');
    const time = new Date().toLocaleTimeString();
    const prefix = kind==='err' ? '[ERR]' : '[OUT]';
    t.innerHTML += `[${time}] ${prefix} ${escapeHtml(String(text))}\n`;
    t.scrollTop = t.scrollHeight;
  }
  function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

  function refreshFileUI() {
    const fl = document.getElementById('fileList');
    fl.innerHTML = '';
    for (const fname of Object.keys(G.files)) {
      const item = document.createElement('div');
      item.className = 'file-item' + (fname===G.activeFile ? ' active' : '');
      item.innerHTML = `<div>${fname}</div><div class="muted small">‚úé</div>`;
      item.onclick = () => { openFile(fname); };
      fl.appendChild(item);
    }
    const tabs = document.getElementById('tabs');
    const tabEls = tabs.querySelectorAll('.tab');
    tabEls.forEach(t => t.classList.remove('active'));
    const myTab = Array.from(tabEls).find(x => x.dataset.fid === G.activeFile);
    if(myTab) myTab.classList.add('active');
  }

  function openFile(name){
    if(!G.files[name]) return;
    G.activeFile = name;
    if(G.editor) G.editor.setValue(G.files[name]);
    refreshFileUI();
    updateLanguageSelectByFile(name);
  }

  function updateLanguageSelectByFile(name){
    const ext = name.split('.').pop();
    const sel = document.getElementById('languageSelect');
    if(ext==='py') sel.value='python';
    else if(ext==='js') sel.value='javascript';
    else if(ext==='c') sel.value='c';
    else if(ext==='cpp') sel.value='cpp';
    else if(ext==='html') sel.value='html';
  }

  document.getElementById('newFile').addEventListener('click', () => {
    let base = 'untitled'; let i=1; while(G.files[`${base}${i}.js`]) i++;
    const fname = `${base}${i}.js`; G.files[fname] = "// novo arquivo\n"; G.activeFile = fname; refreshFileUI(); updateTabsAdd(fname); openFile(fname);
  });
  function updateTabsAdd(fname){
    const tabs = document.getElementById('tabs');
    if(Array.from(tabs.querySelectorAll('.tab')).some(t=>t.dataset.fid===fname)) return;
    const div = document.createElement('div'); div.className='tab'; div.dataset.fid=fname; div.innerText=fname; div.onclick = ()=>openFile(fname);
    tabs.insertBefore(div, tabs.children[3] || tabs.lastChild);
  }

  document.getElementById('shareBtn').addEventListener('click', () => {
    const blob = new Blob([ JSON.stringify(G.files,null,2) ], {type:'application/json'});
    const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='gustocode-project.json'; a.click(); URL.revokeObjectURL(url);
    logTerminal('Projeto exportado (JSON).');
  });

  require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.39.0/min/vs' }});
  require(['vs/editor/editor.main'], function() {
    G.monaco = monaco;
    G.editor = monaco.editor.create(document.getElementById('editor'), {
      value: G.files[G.activeFile], language: 'python', theme: 'vs-dark',
      automaticLayout: true, minimap: { enabled: false }, fontSize:13, wordWrap:"on",
    });

    G.editor.onDidChangeCursorPosition(e=>{ const pos=e.position; document.getElementById('cursorInfo').innerText = `Ln ${pos.lineNumber}, Col ${pos.column}`; });
    G.editor.onDidChangeModelContent(()=> { G.files[G.activeFile] = G.editor.getValue(); });
    G.editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => runActive());
    window.addEventListener('keydown', (ev)=>{ if((ev.ctrlKey||ev.metaKey) && ev.key.toLowerCase()==='s'){ ev.preventDefault(); downloadActive(); } });

    refreshFileUI(); Object.keys(G.files).forEach(updateTabsAdd);
  });

  document.getElementById('languageSelect').addEventListener('change', (e)=>{
    const lang = e.target.value; let monLang = 'plaintext';
    if(lang==='python') monLang='python'; if(lang==='javascript') monLang='javascript'; if(lang==='c' || lang==='cpp') monLang='cpp'; if(lang==='html') monLang='html';
    if(G.monaco) monaco.editor.setModelLanguage(G.editor.getModel(), monLang);
  });

  document.getElementById('runBtn').addEventListener('click', runActive);
  document.getElementById('stopBtn').addEventListener('click', ()=>{ logTerminal('Execu√ß√£o interrompida (simulada).','err'); });

  function insertSnippet(kind){
    if(kind==='py'){ G.editor.setValue("# Snippet Python\nfor i in range(3):\n  print('Ol√°, Augusto!', i)\n"); document.getElementById('languageSelect').value='python'; monaco.editor.setModelLanguage(G.editor.getModel(),'python'); }
    if(kind==='js'){ G.editor.setValue("// Snippet JS\nconsole.log('Ol√°, Augusto!');\n"); document.getElementById('languageSelect').value='javascript'; monaco.editor.setModelLanguage(G.editor.getModel(),'javascript'); }
    if(kind==='c'){ G.editor.setValue("/* Snippet C */\n#include <stdio.h>\nint main(){ printf(\"Ol√°, Augusto!\\n\"); return 0; }\n"); document.getElementById('languageSelect').value='c'; monaco.editor.setModelLanguage(G.editor.getModel(),'cpp'); }
  }

  function downloadActive(){
    const code = G.editor.getValue(); const fname = G.activeFile;
    const blob = new Blob([code], {type
